{% extends 'profile/base.html' %}

{% block title %}My Profile{% endblock %}

{% block sidebar %}
    <aside class="sidebar">
        <div>
            <div class="logo">Favourite Tastebook</div>

            <nav class="nav-section">
                <a href="{% url 'home' %}" class="nav-link">Home</a>

                <a href="{% url 'profile_detail' %}"
                   class="nav-link{% if request.resolver_match.url_name == 'profile_detail' %} nav-link--active{% endif %}">
                    My Account
                </a>

                <a href="{% url 'tastes' %}"
                   class="nav-link {% if request.resolver_match.url_name == 'tastes' %}nav-link--active{% endif %}">
                    Taste Preferences
                </a>

                <a href="{% url 'cookbooks' %}"
                   class="nav-link {% if request.resolver_match.url_name == 'cookbooks' %}nav-link--active{% endif %}">
                    My Cookbooks
                </a>

                <a href="{% url 'saved_recipes' %}"
                   class="nav-link {% if request.resolver_match.url_name == 'saved_recipes' %}nav-link--active{% endif %}">
                    Saved Recipes
                </a>
            </nav>
        </div>

        <p class="sidebar-tip">
            Logged in as <span>{{ request.user.username }}</span>.
        </p>

        <form method="post" action="{% url 'logout' %}" class="logout-form">
            {% csrf_token %}
            <button type="submit" class="logout-btn logout-btn-small">Logout</button>
        </form>
    </aside>
{% endblock %}


{% block content %}
    <section class="profile-header">
        <div>
            <div class="avatar-wrapper">
                {% if profile.avatar %}
                    <img src="{{ profile.avatar.url }}" alt="User avatar">
                {% else %}
                    <div class="avatar-placeholder">
                        {{ request.user.username|first|upper }}
                    </div>
                {% endif %}
            </div>
        </div>

        <div class="header-main">
            <div class="name-row">
                <div class="display-name">
                    {% if request.user.get_full_name %}
                        {{ request.user.get_full_name }}
                    {% else %}
                        {{ request.user.username }}
                    {% endif %}
                </div>
            </div>
            <div class="username">@{{ request.user.username }}</div>

            <div class="meta-row">
                <div class="meta-tag">
                    <span>Preferred Cuisine:</span> {{ profile.get_country_display|default:"Not specified" }}
                </div>
                <div class="meta-tag">
                    <span>Joined:</span> {{ request.user.date_joined|date:"M Y" }}
                </div>
            </div>
        </div>

        <div class="header-actions">
            <a href="{% url 'profile_edit' %}" class="btn">Edit settings</a>
        </div>
    </section>

    <section>
        <h2 class="section-title">Dashboard</h2>
        <div class="placeholder-card">
            Here you will see your recent activity, meal plans, or shopping list.
        </div>
    </section>
{% endblock %}