{# templates/includes/sidebar.html #}
<aside class="sidebar">
  <div>
    <div class="logo">
      <a href="{% url 'home' %}" class="logo-link" aria-label="Go to Home">
        Favourite Tastebook
      </a>
    </div>

    <nav class="nav-section">
      <a href="{% url 'home' %}"
         class="nav-link {% if request.resolver_match.url_name == 'home' %}nav-link--active{% endif %}">
        <span class="nav-text">Home</span>
      </a>

      <a href="{% url 'profile_detail' %}"
         data-auth-required="1"
         class="nav-link {% if request.resolver_match.url_name == 'profile_detail' %}nav-link--active{% endif %}">
        <span class="nav-text">My Account</span>

        {% if not user.is_authenticated %}
          <button type="button"
                  class="nav-lock-btn"
                  data-go-login="1"
                  aria-label="Registered users only">
            ðŸ”’
          </button>
        {% endif %}
      </a>

      <a href="{% url 'profile_edit' %}"
         data-auth-required="1"
         class="nav-link {% if request.resolver_match.url_name == 'profile_edit' %}nav-link--active{% endif %}">
        <span class="nav-text">Settings</span>

        {% if not user.is_authenticated %}
          <button type="button"
                  class="nav-lock-btn"
                  data-go-login="1"
                  aria-label="Registered users only">
            ðŸ”’
          </button>
        {% endif %}
      </a>

      <a href="{% url 'tastes' %}"
         data-auth-required="1"
         class="nav-link {% if request.resolver_match.url_name == 'tastes' %}nav-link--active{% endif %}">
        <span class="nav-text">Taste Preferences</span>

        {% if not user.is_authenticated %}
          <button type="button"
                  class="nav-lock-btn"
                  data-go-login="1"
                  aria-label="Registered users only">
            ðŸ”’
          </button>
        {% endif %}
      </a>

      <a href="{% url 'cookbooks' %}"
         data-auth-required="1"
         class="nav-link {% if request.resolver_match.url_name == 'cookbooks' %}nav-link--active{% endif %}">
        <span class="nav-text">My Cookbooks</span>

        {% if not user.is_authenticated %}
          <button type="button"
                  class="nav-lock-btn"
                  data-go-login="1"
                  aria-label="Registered users only">
            ðŸ”’
          </button>
        {% endif %}
      </a>

      <a href="{% url 'saved_recipes' %}"
         data-auth-required="1"
         class="nav-link {% if request.resolver_match.url_name == 'saved_recipes' %}nav-link--active{% endif %}">
        <span class="nav-text">Saved Recipes</span>

        {% if not user.is_authenticated %}
          <button type="button"
                  class="nav-lock-btn"
                  data-go-login="1"
                  aria-label="Registered users only">
            ðŸ”’
          </button>
        {% endif %}
      </a>
    </nav>
  </div>

  <div class="sidebar-footer">
    {% if user.is_authenticated %}
      <div class="sidebar-user">
        <div class="sidebar-user-avatar" aria-hidden="true">
          {% if user.profile.avatar %}
            <img src="{{ user.profile.avatar.url }}" alt="Profile avatar">
          {% else %}
            <span class="sidebar-user-initial">{{ user.get_username|first|upper }}</span>
          {% endif %}
        </div>

        <div class="sidebar-user-meta">
          <div class="sidebar-user-label">Logged in as</div>
          <div class="sidebar-user-name">
            {% with uname=user.get_username %}
              {% if uname %}{{ uname }}{% else %}User #{{ user.id }}{% endif %}
            {% endwith %}
          </div>
        </div>
      </div>

      <form method="post" action="{% url 'logout' %}" class="logout-form">
        {% csrf_token %}
        <button type="submit" class="logout-btn logout-btn-small">Logout</button>
      </form>
    {% else %}
      <p class="sidebar-tip">
        You are not logged in. Please log in to use all the appâ€™s features.
      </p>

      <div class="sidebar-actions">
        <a class="btn btn-secondary btn-small" href="{% url 'login' %}">Authentication</a>
      </div>
    {% endif %}
  </div>
</aside>
